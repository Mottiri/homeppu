# 機能修正・追加バックログ (2025-12-18)

このドキュメントは、ほめっぷアプリの細かい修正と追加機能の提案をまとめたものです。

---

## 📋 タスク機能

### 1. カテゴリフィルタリング ✅
- **優先度**: 高
- **状態**: ✅ 実装済み（確認完了 2025-12-18）
- **内容**: 
  - タスク一覧にカテゴリフィルターを追加
  - カテゴリをタップすると、そのカテゴリに紐づくタスクのみ表示
  - 例: ゲームカテゴリ選択 → ゲームに紐づくタスク2件のみ表示
- **実装箇所**: `tasks_screen.dart`
  - TabBarでカテゴリタブを動的生成
  - TabBarViewでカテゴリごとにタスクリストを表示
  - 「+」タブで新規カテゴリ追加可能

### 2. 月間カレンダーの完了タスク優先非表示
- **優先度**: 中
- **状態**: 未着手
- **内容**:
  - 複数タスクがある日で「+9」などで省略される場合
  - 完了済みタスクを優先的に省略（非表示）にする
  - 未完了タスクを優先的に表示

### 3. タスク表示設定機能
- **優先度**: 中
- **状態**: 未着手
- **内容**:
  - タスク画面のヘッダーに設定アイコン（⚙️）を配置
  - タップでボトムシート表示
  - 表示/非表示の切替項目:
    - メモを表示 [ON/OFF]
    - 繰り返しアイコン [ON/OFF]
    - 添付画像サムネイル [ON/OFF]
    - リマインダーアイコン [ON/OFF]
    - サブタスク表示 [ON/OFF]
  - 設定は端末に保存（SharedPreferences）

### 3. カスタム画像設定（アイコン・ヘッダー）
- **優先度**: 中
- **状態**: 未着手
- **内容**:
  - サークル作成時・作成後にオーナーがアイコン・ヘッダー画像を設定可能
  - 画像サイズの自動調整
  - ヘッダー画像をサークル一覧カードの背景に透過表示

### 4. 「プログラミング」カテゴリの削除
- **優先度**: 低
- **状態**: 未着手
- **内容**:
  - サークルカテゴリから「プログラミング」を削除
  - ターゲット層に合わせたカテゴリ整理

---

## ❤️ リアクション機能

### 5. リアクションアイコンのカテゴリ分け
- **優先度**: 高
- **状態**: 未着手
- **内容**:
  - リアクションボタン押下時、アイコンをカテゴリ別に整理
  - 背景の投稿が見えなくなる問題を解消

### 6. リアクション時のアニメーション強化
- **優先度**: 中
- **状態**: 未着手
- **内容**:
  - リアクション押下時のアニメーション演出
  - **仕様**: リアクション直後は大きいサイズのアイコン → だんだん小さくなる → 背景に溶け込んで最終サイズになる
  - AI・ユーザー問わず全員に見えるアニメーション
  - リアクションを付けた側も、付けられた側も、TL閲覧者もアニメーションが見える

> [!NOTE]
> **決定**: AI/ユーザー共通のアニメーションのため、AIバレの懸念なし（2025-12-18）

### 7. リアクション回数制限
- **優先度**: 高
- **状態**: 未着手
- **内容**:
  - 1人あたり1投稿に対して最大5回まで
  - スパム防止

### 8. AIリアクション数の調整
- **優先度**: 中
- **状態**: 未着手
- **内容**:
  - AIは1投稿に1回のみリアクション
  - **MAX15件、平均10件程度**に調整
  - 理由: 30件は通知が多すぎる、MIXモードへの誘導のため

> [!NOTE]
> **決定**: MAX15件、平均10件で合意（2025-12-18）

---

## 👤 プロフィール画面

### 9. 賞賛カウントの修正（バグ）✅
- **優先度**: 高
- **状態**: ✅ 完了（2025-12-18）
- **内容**:
  - 「賞賛」の項目がカウントされていない問題を修正
- **実装内容**:
  - `onReactionCreated` トリガーを Cloud Functions に追加
  - リアクション追加時に投稿者の `totalPraises` を自動インクリメント
  - 自己リアクションはカウントしない

### 10. 投稿カードのスマート化
- **優先度**: 中
- **状態**: 未着手
- **内容**:
  - 過去の投稿カードをコンパクトに表示
  - 画像添付、コメント数、リアクション有無はアイコンで表現
  - タップで詳細画面へ遷移

### 11. お気に入り投稿機能
- **優先度**: 中
- **状態**: 未着手
- **内容**:
  - 過去の投稿をお気に入り登録
  - お気に入り投稿は上部に表示
  - 過去の賞賛をいつでも見返せる

> [!NOTE]
> **決定**: 名称は「お気に入り」で進行（2025-12-18）

---

## ✏️ 投稿画面

### 12. 添付アイコンの変更
- **優先度**: 低
- **状態**: 未着手
- **内容**:
  - クリップアイコン → 「+」アイコンに変更

---

## 🔔 通知画面

### 13. 通知のカテゴリ分け
- **優先度**: 中
- **状態**: 未着手
- **内容**:
  - カテゴリ:
    - **TL通知**: コメント、リアクション
    - **サークル通知**: サークル変更、申請関連
    - **タスク通知**: リマインダー、予定時刻
  - 未読バッジ表示（例: ①）

---

## 🛡️ 管理者機能

### 14. 管理者専用機能
- **優先度**: 低（運用フェーズでは必須）その他機能を作り終えたら高
- **状態**: 未実装
- **内容**:
  - BAN権限
  - 通報一覧確認
  - 問い合わせ一覧確認と返信
  - 管理者アカウントのみに表示
  - **管理者アカウント**: `movielike4@gmail.com`

---

## 🎨 UI全般

### 15. UI調整
- **優先度**: 低（機能実装後）
- **状態**: 未着手
- **内容**:
  - 全体的なUIのブラッシュアップ
  - 機能改修・追加完了後に着手

---

## 💰 マネタイズ

### 16. 広告表示
- **優先度**: 中
- **状態**: 未実装
- **内容**:
  - 基本は広告表示

### 17. サブスクリプション課金
- **優先度**: 中
- **状態**: 未実装
- **内容（要議論）**:

### 課金モデル（決定版）
| 無料 | サブスク（プレミアム） |
|------|----------------------|
| 全タスク機能 | 広告OFF |
| 基本名前パーツ | レア名前パーツ解放 |
| 基本アバター | 限定アバターパーツ |
| サークル参加 | サークル作成数増加 |
| - | **投稿装飾機能** |
| - | [プレミアム][課金者] バッジ |

### 投稿装飾機能（技術確認済み）
- **技術的に実装可能** ✅
- **実装方法**: `Stack` + `Positioned` widgetでカード角に装飾配置
- **装飾例**:
  - 王冠（プレミアムバッジ）
  - キラキラ（パーティクルエフェクト）
  - 豪華フレーム
  - 背景パターン

---

## 📛 名前パーツ

### 18. アイコン位置の調整
- **優先度**: -（対応不要）
- **状態**: 現状維持に決定
- **内容**:
  - 現在のアイコン位置（真ん中）を維持

> [!NOTE]
> **議論点**: アイコンがあることで視覚的な識別性が上がり、他SNSとの差別化になる。
> 現状維持を推奨。

---

## 更新履歴

| 日付 | 内容 |
|------|------|
| 2025-12-18 | 初版作成 |
